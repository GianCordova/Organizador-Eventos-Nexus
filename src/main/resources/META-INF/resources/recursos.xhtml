<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Gestión de Recursos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-container, .table-container { margin-bottom: 30px; border: 1px solid #ccc; padding: 20px; border-radius: 8px; }
        .form-container h2, .table-container h2 { margin-top: 0; }
        .form-row { margin-bottom: 15px; }
        .form-row label { display: block; font-weight: bold; margin-bottom: 5px; }
        .form-row input, .form-row select { width: 100%; padding: 8px; box-sizing: border-box; }
        .button-group button { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
        .button-group .save-button { background-color: #28a745; color: white; margin-right: 10px; }
        .button-group .update-button { background-color: #007bff; color: white; margin-right: 10px; }
        .table-container table { width: 100%; border-collapse: collapse; }
        .table-container th, .table-container td { border: 1px solid #ccc; padding: 10px; text-align: left; }
        .table-container th { background-color: #f2f2f2; }
        .table-actions button { background-color: #dc3545; color: white; border: none; padding: 5px 10px; cursor: pointer; margin-right: 5px; }
        .table-actions .edit-button { background-color: #ffc107; color: #212529; }
        .messages { list-style: none; padding: 0; }
        .messages .info { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
        .messages .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
    </style>
</h:head>
<h:body>
    <h1>Gestión de Recursos</h1>

    <h:messages globalOnly="true" class="messages" infoClass="info" errorClass="error"/>

    <div class="form-container">
        <h2>
            <h:outputText value="Nuevo Recurso" rendered="#{recursoJsfController.nuevoRecurso.idRecurso eq null}" />
            <h:outputText value="Editar Recurso" rendered="#{recursoJsfController.nuevoRecurso.idRecurso ne null}" />
        </h2>
        <h:form>
            <div class="form-row">
                <h:outputLabel for="nombre" value="Nombre del Recurso:" />
                <h:inputText id="nombre" value="#{recursoJsfController.nuevoRecurso.resourceName}" required="true" />
            </div>

            <div class="form-row">
                <h:outputLabel for="categoria" value="Categoría:" />
                <h:selectOneMenu id="categoria" value="#{recursoJsfController.nuevoRecurso.category}" required="true">
                    <f:selectItems value="#{recursoJsfController.categorias}" var="cat" itemLabel="#{cat.name()}" itemValue="#{cat}" />
                </h:selectOneMenu>
            </div>

            <div class="form-row">
                <h:outputLabel for="stock" value="Stock:" />
                <p:inputNumber id="stock" value="#{recursoJsfController.nuevoRecurso.stock}" required="true" />
            </div>

            <div class="form-row">
                <h:outputLabel for="precio" value="Precio de Alquiler:" />
                <p:inputNumber id="precio"
                               value="#{recursoJsfController.nuevoRecurso.rentalPrice}"
                               required="true"
                               minValue="0"
                               maxValue="10000"
                               maxFractionDigits="2"
                               converterMessage="Ingrese un número válido"
                               requiredMessage="El precio es obligatorio"
                               mode="currency"
                               currencySymbol="$" />
            </div>

            <div class="button-group">
                <h:commandButton value="Guardar"
                                 actionListener="#{recursoJsfController.guardarRecurso}"
                                 rendered="#{recursoJsfController.nuevoRecurso.idRecurso eq null}"
                                 styleClass="save-button">
                </h:commandButton>

                <h:commandButton value="Actualizar"
                                 actionListener="#{recursoJsfController.actualizarRecurso}"
                                 rendered="#{recursoJsfController.nuevoRecurso.idRecurso ne null}"
                                 styleClass="update-button">
                    <f:ajax execute="@form" render="@all" />
                </h:commandButton>
            </div>
        </h:form>
    </div>

    <div class="table-container">
        <h2>Listado de Recursos</h2>
        <h:form>
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Categoría</th>
                    <th>Stock</th>
                    <th>Precio Alquiler</th>
                    <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                <h:outputText value="No hay recursos registrados." rendered="#{empty recursoJsfController.listaRecursos}" />
                <ui:repeat var="recurso" value="#{recursoJsfController.listaRecursos}">
                    <tr>
                        <td>#{recurso.idRecurso}</td>
                        <td>#{recurso.resourceName}</td>
                        <td>#{recurso.category}</td>
                        <td>#{recurso.stock}</td>
                        <td>#{recurso.rentalPrice}</td>
                        <td class="table-actions">
                            <h:commandButton value="Editar"
                                             actionListener="#{recursoJsfController.seleccionarRecurso(recurso)}"
                                             styleClass="edit-button">
                                <f:ajax execute="@this" render="@all" />
                            </h:commandButton>

                            <h:commandButton value="Eliminar"
                                             actionListener="#{recursoJsfController.eliminarRecurso(recurso.idRecurso)}">
                                <f:ajax execute="@this" render="@all" />
                            </h:commandButton>
                        </td>
                    </tr>
                </ui:repeat>
                </tbody>
            </table>
        </h:form>
    </div>
</h:body>
</html>
